@use "@imarc/pronto/resources/styles/imported" as *;

.cards {
  $b: &;

  --columns: 1;
  --gap: var(--root-gap, 16px);
  --min-column: 240px;

  display: grid;
  gap: var(--gap);
  grid-template-columns: repeat(var(--columns), 1fr);

  // Allow auto-fit wrapping before fixed columns kick in
  @include at(sm) {
    grid-template-columns: repeat(
      auto-fit,
      minmax(min(100%, var(--min-column)), 1fr)
    );
  }

  // Responsive defaults: 1 mobile, 2 tablet+
  @include at(md) {
    --columns: 2;
  }

  @include at(lg) {
    grid-template-columns: repeat(var(--columns), 1fr);
  }

  // Column modifiers (2-5 columns on tablet+)
  @for $i from 2 through 5 {
    &.-columns-#{$i} {
      @include at(md) {
        --columns: #{$i};
      }
    }
  }


  // Center orphan cards using doubled grid columns
  // Cards span 2 columns, orphans positioned to center
  &.-centered {
    > .card {
      grid-column: span 2;
    }

    // 3 visual columns = 6 grid columns (default for -centered)
    @include at(md) {
      grid-template-columns: repeat(6, 1fr);

      // 4 cards (3 + 1): center the orphan
      > .card:nth-child(4):nth-last-child(1) {
        grid-column: 3 / 5;
      }

      // 5 cards (3 + 2): center the 2 orphans
      > .card:nth-child(4):nth-last-child(2) {
        grid-column: 2 / 4;
      }
      > .card:nth-child(5):nth-last-child(1) {
        grid-column: 4 / 6;
      }
    }

    // 4 visual columns = 8 grid columns
    &.-columns-4 {
      @include at(md) {
        grid-template-columns: repeat(8, 1fr);

        // Reset 3-column orphan positioning
        > .card:nth-child(4):nth-last-child(1),
        > .card:nth-child(4):nth-last-child(2),
        > .card:nth-child(5):nth-last-child(1) {
          grid-column: span 2;
        }

        // 5 cards (4 + 1): center the orphan
        > .card:nth-child(5):nth-last-child(1) {
          grid-column: 4 / 6;
        }

        // 6 cards (4 + 2): center the 2 orphans
        > .card:nth-child(5):nth-last-child(2) {
          grid-column: 3 / 5;
        }
        > .card:nth-child(6):nth-last-child(1) {
          grid-column: 5 / 7;
        }

        // 7 cards (4 + 3): center the 3 orphans
        > .card:nth-child(5):nth-last-child(3) {
          grid-column: 2 / 4;
        }
        > .card:nth-child(6):nth-last-child(2) {
          grid-column: 4 / 6;
        }
        > .card:nth-child(7):nth-last-child(1) {
          grid-column: 6 / 8;
        }
      }
    }

    // 5 visual columns = 10 grid columns
    &.-columns-5 {
      @include at(md) {
        grid-template-columns: repeat(10, 1fr);

        // Reset previous orphan positioning
        > .card:nth-child(4):nth-last-child(1),
        > .card:nth-child(4):nth-last-child(2),
        > .card:nth-child(5):nth-last-child(1),
        > .card:nth-child(5):nth-last-child(2),
        > .card:nth-child(5):nth-last-child(3),
        > .card:nth-child(6):nth-last-child(1),
        > .card:nth-child(6):nth-last-child(2),
        > .card:nth-child(7):nth-last-child(1) {
          grid-column: span 2;
        }

        // 6 cards (5 + 1): center the orphan
        > .card:nth-child(6):nth-last-child(1) {
          grid-column: 5 / 7;
        }

        // 7 cards (5 + 2): center the 2 orphans
        > .card:nth-child(6):nth-last-child(2) {
          grid-column: 4 / 6;
        }
        > .card:nth-child(7):nth-last-child(1) {
          grid-column: 6 / 8;
        }

        // 8 cards (5 + 3): center the 3 orphans
        > .card:nth-child(6):nth-last-child(3) {
          grid-column: 3 / 5;
        }
        > .card:nth-child(7):nth-last-child(2) {
          grid-column: 5 / 7;
        }
        > .card:nth-child(8):nth-last-child(1) {
          grid-column: 7 / 9;
        }

        // 9 cards (5 + 4): center the 4 orphans
        > .card:nth-child(6):nth-last-child(4) {
          grid-column: 2 / 4;
        }
        > .card:nth-child(7):nth-last-child(3) {
          grid-column: 4 / 6;
        }
        > .card:nth-child(8):nth-last-child(2) {
          grid-column: 6 / 8;
        }
        > .card:nth-child(9):nth-last-child(1) {
          grid-column: 8 / 10;
        }
      }
    }
  }
}

